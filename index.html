<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Counterparty Verification - Registry Cross‑Check (Mock Demo)</title>
  <style>
    :root {
      --bg: #0f172a;        /* slate-900 */
      --card: #111827;      /* gray-900 */
      --ink: #e5e7eb;       /* gray-200 */
      --ink-dim: #9ca3af;   /* gray-400 */
      --accent: #3b82f6;    /* blue-500 */
      --success: #10b981;   /* emerald-500 */
      --danger: #ef4444;    /* red-500 */
      --warning: #f59e0b;   /* amber-500 */
      --muted: #1f2937;     /* gray-800 */
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(180deg, #0b1220, #0f172a 40% 60%, #0b1220);
      color: var(--ink);
    }
    .wrap { max-width: 880px; margin: 0 auto; padding: 24px; }
    header { display: flex; align-items: center; justify-content: space-between; gap: 16px; }
    .brand { display: flex; align-items: center; gap: 10px; }
    .logo { width: 36px; height: 36px; display: grid; place-items: center; border-radius: 10px; background: radial-gradient(circle at 30% 30%, #60a5fa, #3b82f6 60%, #1e40af); box-shadow: 0 10px 30px rgba(59,130,246,.35); font-weight: 800; }
    .logo span { font-size: 18px; letter-spacing: .5px; }
    .brand h1 { font-size: 16px; margin: 0; line-height: 1.2; }
    .subtitle { color: var(--ink-dim); font-size: 13px; margin-top: 2px; }

    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 16px; padding: 20px; box-shadow: 0 20px 50px rgba(0,0,0,.45);
    }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    @media (max-width: 720px) { .grid { grid-template-columns: 1fr; } header { flex-direction: column; align-items: flex-start; } }

    label { font-size: 13px; color: var(--ink-dim); margin-bottom: 6px; display: block; }
    input, select {
      width: 100%; padding: 12px 12px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);
      background: #0b1020; color: var(--ink); outline: none;
    }
    input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(59,130,246,.15); }

    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    @media (max-width: 720px) { .row { grid-template-columns: 1fr; } }

    .actions { display: flex; gap: 12px; flex-wrap: wrap; align-items: center; }
    button {
      appearance: none; border: none; cursor: pointer;
      background: var(--accent); color: white; padding: 12px 16px; border-radius: 12px; font-weight: 700;
      box-shadow: 0 10px 24px rgba(59,130,246,.35);
    }
    button.secondary { background: #111827; color: var(--ink); border: 1px solid rgba(255,255,255,.1); box-shadow: none; }
    button.ghost { background: transparent; border: 1px dashed rgba(255,255,255,.25); color: var(--ink-dim); }

    .hint { font-size: 12px; color: var(--ink-dim); margin-top: 6px; }

    .status { margin-top: 14px; font-size: 14px; }
    .badge { display: inline-flex; align-items: center; gap: 8px; padding: 8px 10px; border-radius: 999px; border: 1px solid rgba(255,255,255,.1); background: #0b1020; }

    .results { margin-top: 18px; display: none; }
    .result-item { padding: 14px; border-radius: 12px; background: #0b1020; border: 1px solid rgba(255,255,255,.08); margin-top: 12px; }

    .ok { color: var(--success); }
    .warn { color: var(--warning); }
    .err { color: var(--danger); }

    .small { font-size: 12px; color: var(--ink-dim); }
    .footnote { margin-top: 18px; font-size: 12px; color: var(--ink-dim); }
    .muted { color: var(--ink-dim); }

    .spinner {
      width: 18px; height: 18px; border: 2px solid rgba(255,255,255,.2); border-top-color: #fff; border-radius: 50%;
      animation: spin 0.9s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .sample-box { margin-top: 10px; padding: 10px; border-radius: 12px; background: rgba(255,255,255,.03); border: 1px dashed rgba(255,255,255,.12); }
    .samples { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
    .chip { font-size: 12px; padding: 6px 10px; border-radius: 999px; background: #111827; border: 1px solid rgba(255,255,255,.15); cursor: pointer; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"><span>GD</span></div>
        <div>
          <h1>Counterparty Verification – Registry Cross‑Check (Mock)</h1>
          <div class="subtitle">Real‑time check of user against officers and shareholders in business registries – demo simulation powered by Global Database</div>
        </div>
      </div>
    </header>

    <main style="margin-top: 18px;">
      <section class="card" aria-labelledby="form-title">
        <h2 id="form-title" style="margin:0 0 10px 0; font-size: 18px;">Onboarding form – what your user would see</h2>
        <div class="grid">
          <div>
            <label for="fullName">Full name</label>
            <input id="fullName" autocomplete="name" placeholder="Type a full name" />
          </div>
          <div>
            <label for="company">Company name</label>
            <input id="company" autocomplete="organization" placeholder="Type a company name" />
          </div>
          <div>
            <label for="country">Country</label>
            <select id="country">
              <option value="GB">United Kingdom</option>
              <option value="IE">Ireland</option>
              <option value="FR">France</option>
              <option value="DE">Germany</option>
            </select>
            <div class="hint">Country scoping improves match precision.
            </div>
          </div>
          <div>
            <label for="dob">Date of birth – optional</label>
            <input id="dob" type="date" />
            <div class="hint">Used to disambiguate common names.
            </div>
          </div>
        </div>

        <div class="actions" style="margin-top: 16px;">
          <button id="verifyBtn" type="button">Verify against registry</button>
          <button id="resetBtn" type="button" class="secondary">Reset</button>
          <button id="prefill1" type="button" class="ghost">Quick fill example A</button>
          <button id="prefill2" type="button" class="ghost">Quick fill example B</button>
        </div>

        <div class="status" id="status" aria-live="polite" style="min-height: 32px; display:flex; align-items:center; gap:10px;"></div>

        <div class="results" id="results">
          <!-- Results will be injected here -->
        </div>

        <div class="footnote">This is a front‑end only simulation – no personal data is sent anywhere. The sample registry below is fictional, created for demonstration. In production, this would call the Global Database API in your backend and return signed results.</div>
      </section>

      <section class="card" style="margin-top: 16px;">
        <h3 style="margin-top:0; font-size: 16px;">What is being checked</h3>
        <p class="muted">The verification checks if the person appears as an <strong>officer</strong> or <strong>shareholder</strong> of the named company in the selected country. It also validates that the company exists and is active.</p>

        <div class="sample-box">
          <div class="small">Try these examples exactly as shown</div>
          <div class="samples" id="sampleChips"></div>
        </div>
      </section>

      <section class="card" style="margin-top: 16px;">
        <h3 style="margin: 0 0 8px 0; font-size: 16px;">Sample registry dataset used in this mock</h3>
        <p class="small">Fictional records for demo only</p>
        <div id="dataPreview" class="small"></div>
      </section>

    </main>

    <footer style="margin: 18px 0 40px 0;" class="small muted">
      © <span id="year"></span> Global Database – Registry‑sourced company data demo. Not affiliated with Yoti. For demonstration only.
    </footer>
  </div>

  <script>
    // --- Demo dataset: fictional, UK‑flavoured entries --- //
    // Each company has: name, country, status, officers[], shareholders[], optional dob for disambiguation
    const REGISTRY = [
      {
        company: "Northbridge Identity Ltd",
        country: "GB",
        status: "Active",
        officers: [
          { name: "Kamila Hart", role: "Director", dob: "1988-03-14" },
          { name: "David Nwosu", role: "Director", dob: "1985-11-09" }
        ],
        shareholders: [
          { name: "Kamila Hart", shares: "40%" },
          { name: "Yusuf Patel", shares: "60%" }
        ]
      },
      {
        company: "Riverbank Payments UK Ltd",
        country: "GB",
        status: "Active",
        officers: [
          { name: "Mark Stokes", role: "CEO", dob: "1979-05-22" },
          { name: "Alice Bennett", role: "CFO", dob: "1986-10-05" }
        ],
        shareholders: [
          { name: "Alice Bennett", shares: "15%" },
          { name: "Harbor Ventures LLP", shares: "85%" }
        ]
      },
      {
        company: "Bright Ledger Solutions Limited",
        country: "IE",
        status: "Active",
        officers: [
          { name: "Finn O'Rourke", role: "Director", dob: "1984-02-01" }
        ],
        shareholders: [
          { name: "Finn O'Rourke", shares: "100%" }
        ]
      },
      {
        company: "HexaTrust SAS",
        country: "FR",
        status: "Active",
        officers: [
          { name: "Élodie Marchand", role: "Présidente", dob: "1990-07-19" }
        ],
        shareholders: [
          { name: "Élodie Marchand", shares: "35%" },
          { name: "Alain Robert", shares: "65%" }
        ]
      },
      {
        company: "Bergwerk Daten GmbH",
        country: "DE",
        status: "Dissolved",
        officers: [
          { name: "Johannes Keller", role: "Geschäftsführer", dob: "1976-01-12" }
        ],
        shareholders: [
          { name: "Johannes Keller", shares: "100%" }
        ]
      }
    ];

    const EXAMPLES = [
      { fullName: "Alice Bennett", company: "Riverbank Payments UK Ltd", country: "GB", dob: "1986-10-05" },
      { fullName: "Kamila Hart", company: "Northbridge Identity Ltd", country: "GB", dob: "1988-03-14" },
      { fullName: "Finn O'Rourke", company: "Bright Ledger Solutions Limited", country: "IE", dob: "1984-02-01" }
    ];

    const $ = (id) => document.getElementById(id);
    const fmt = (s) => (s || "").trim().toLowerCase();

    const status = $("status");
    const results = $("results");

    function setStatus(kind, text, showSpinner=false) {
      status.innerHTML = "";
      const badge = document.createElement("div");
      badge.className = "badge";
      if (showSpinner) {
        const spin = document.createElement("div");
        spin.className = "spinner";
        badge.appendChild(spin);
      }
      const span = document.createElement("span");
      span.textContent = text;
      if (kind === "ok") span.classList.add("ok");
      if (kind === "warn") span.classList.add("warn");
      if (kind === "err") span.classList.add("err");
      badge.appendChild(span);
      status.appendChild(badge);
    }

    function renderResults(items) {
      results.style.display = "block";
      results.innerHTML = "";
      if (!items || !items.length) {
        const box = document.createElement("div");
        box.className = "result-item";
        box.innerHTML = `<div class="err"><strong>No registry match found</strong></div>
          <div class="small">Tip: try one of the quick-fill examples above. In production, broader graph search would check group structures and historic roles.</div>`;
        results.appendChild(box);
        return;
      }
      for (const it of items) {
        const box = document.createElement("div");
        box.className = "result-item";
        box.innerHTML = `
          <div style="display:flex; justify-content:space-between; gap:10px; align-items:center;">
            <div>
              <div style="font-weight:700;">${it.company} – ${it.country}</div>
              <div class="small ${it.status === 'Active' ? 'ok' : 'warn'}">Status: ${it.status}</div>
            </div>
            <div class="small">Match type: <strong>${it.matchType}</strong></div>
          </div>
          <div class="small" style="margin-top:8px;">Person: <strong>${it.person}</strong>${it.dob ? `, DOB ${it.dob}` : ''}</div>
          ${it.role ? `<div class="small">Officer role: ${it.role}</div>` : ''}
          ${it.shares ? `<div class="small">Shareholding: ${it.shares}</div>` : ''}
        `;
        results.appendChild(box);
      }
    }

    function verify() {
      const name = fmt($("fullName").value);
      const company = fmt($("company").value);
      const country = $("country").value;
      const dobValue = $("dob").value ? $("dob").value : null;

      results.style.display = "none";

      if (!name || !company) {
        setStatus("err", "Please enter full name and company to verify.");
        return;
      }

      setStatus("warn", "Checking registry…", true);

      // Simulate network latency
      setTimeout(() => {
        const matched = [];
        for (const rec of REGISTRY) {
          if (rec.country !== country) continue;
          if (fmt(rec.company) !== company) continue;

          // Officers
          for (const off of rec.officers) {
            if (fmt(off.name) === name && (!dobValue || off.dob === dobValue)) {
              matched.push({ company: rec.company, country: rec.country, status: rec.status, person: off.name, dob: off.dob || null, role: off.role, matchType: "Officer" });
            }
          }
          // Shareholders
          for (const sh of rec.shareholders) {
            if (fmt(sh.name) === name && (!dobValue || null)) {
              matched.push({ company: rec.company, country: rec.country, status: rec.status, person: sh.name, shares: sh.shares, matchType: "Shareholder" });
            }
          }
        }

        if (matched.length) {
          setStatus("ok", `Verified in registry – ${matched.length} match${matched.length>1?'es':''} found`);
        } else {
          setStatus("err", "No match in registry records for provided inputs.");
        }
        renderResults(matched);
      }, 750);
    }

    function resetForm() {
      $("fullName").value = "";
      $("company").value = "";
      $("country").value = "GB";
      $("dob").value = "";
      results.style.display = "none";
      status.innerHTML = "";
    }

    function prefill(ex) {
      $("fullName").value = ex.fullName;
      $("company").value = ex.company;
      $("country").value = ex.country;
      $("dob").value = ex.dob || "";
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // UTM echo – shows where the prospect came from if you include UTM in the email link
    function echoUTM() {
      const params = new URLSearchParams(location.search);
      const known = ["utm_source","utm_medium","utm_campaign","utm_content","utm_term"];
      const found = [];
      known.forEach(k => { if (params.get(k)) found.push(`${k}=${params.get(k)}`); });
      if (found.length) {
        const div = document.createElement('div');
        div.className = 'small';
        div.style.marginTop = '8px';
        div.textContent = `Tracking: ${found.join(' · ')}`;
        document.querySelector('header').appendChild(div);
      }
    }

    // Populate sample chips and data preview
    function initSamples() {
      const chips = $("sampleChips");
      EXAMPLES.forEach((ex, i) => {
        const c = document.createElement("button");
        c.type = "button"; c.className = "chip";
        c.textContent = `${ex.fullName} – ${ex.company} (${ex.country})`;
        c.addEventListener('click', () => prefill(ex));
        chips.appendChild(c);
      });

      const prev = $("dataPreview");
      const tbl = document.createElement('table');
      tbl.style.width = '100%';
      tbl.style.borderCollapse = 'collapse';
      tbl.style.marginTop = '8px';

      const head = document.createElement('tr');
      ["Company","Country","Status","Officers","Shareholders"].forEach(h => {
        const th = document.createElement('th'); th.textContent = h; th.style.textAlign='left'; th.style.padding='6px 4px'; th.style.borderBottom='1px solid rgba(255,255,255,.15)'; th.style.fontSize='12px'; th.style.color='var(--ink-dim)'; tbl.appendChild(head); head.appendChild(th);
      });

      REGISTRY.forEach(r => {
        const tr = document.createElement('tr');
        const tds = [
          r.company,
          r.country,
          r.status,
          r.officers.map(o=>`${o.name}${o.role?` (${o.role})`:''}${o.dob?` · DOB ${o.dob}`:''}`).join('; '),
          r.shareholders.map(s=>`${s.name}${s.shares?` ${s.shares}`:''}`).join('; ')
        ];
        tds.forEach(v => { const td = document.createElement('td'); td.textContent = v; td.style.padding='8px 4px'; td.style.borderBottom='1px solid rgba(255,255,255,.08)'; td.style.fontSize='12px'; tr.appendChild(td); });
        tbl.appendChild(tr);
      });
      prev.appendChild(tbl);
    }

    // Wire up
    $("verifyBtn").addEventListener('click', verify);
    $("resetBtn").addEventListener('click', resetForm);
    $("prefill1").addEventListener('click', () => prefill(EXAMPLES[0]));
    $("prefill2").addEventListener('click', () => prefill(EXAMPLES[1]));
    $("year").textContent = new Date().getFullYear();

    initSamples();
    echoUTM();
  </script>
</body>
</html>
